(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,function(e,t,n){},function(e,t,n){},,,function(e,t,n){e.exports=n(22)},,,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),c=n.n(o),i=(n(15),n(3)),u=(n(5),n(1)),s=n.n(u),l=n(2);function m(){var e=document.querySelector("summary img.avatar");return e?{id:(e.getAttribute("alt")||"").substring(1),avatar:e.getAttribute("src")}:null}function f(){return p.apply(this,arguments)}function p(){return(p=Object(l.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){chrome.storage.sync.get(["github_token","github_id","github_avatar"],function(t){if(t.github_token)e({token:t.github_token||null,id:t.github_id||null,avatar:t.github_avatar||null});else{var n=m();e({token:null,id:n?n.id:null,avatar:n?n.avatar:null})}})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(e){return d.apply(this,arguments)}function d(){return(d=Object(l.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){chrome.storage.sync.set({github_token:t},function(){e()})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g(e,t){return b.apply(this,arguments)}function b(){return(b=Object(l.a)(s.a.mark(function e(t,n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){chrome.storage.sync.set({github_id:t,github_avatar:n},function(){e()})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var v="9b9e17e168e82438cfb6",y="https://us-central1-git-meme-prod.cloudfunctions.net/api";n(17);var E=n(8),w=n.n(E),k=(n(18),n(6),w()({}));function x(e){var t=Object(a.useState)(-1),n=Object(i.a)(t,2),o=n[0],c=n[1];return r.a.createElement("div",{className:"ListWithBadges"},r.a.createElement("div",{className:"listHeader"},r.a.createElement("span",{className:"listLabel"},e.label),e.items.length>0?r.a.createElement("span",{className:"timesUsed"},"Times used"):null),e.items.length>0?function(e,t,n){function a(t){var a=t.target,r=parseInt(a.getAttribute("data-idx")||"-1",0),o=e.items[r].token;!function(e){var t=document.documentElement;if(!t||!document.body)return!1;var n="rtl"===t.getAttribute("dir"),a=document.createElement("textarea");function r(e,t){a.style.setProperty(e,t)}r("fontSize","12pt"),r("border","0"),r("padding","0"),r("margin","0"),r("position","absolute"),r(n?"right":"left","-9999px");var o=window.pageYOffset||t.scrollTop;if(r("top","".concat(o,"px")),a.setAttribute("readonly",""),a.value=e,!document.body)return!1;document.body.appendChild(a),a.focus(),a.selectionStart=0,a.selectionEnd=e.length;var c=!1;try{c=document.execCommand("copy")}catch(i){c=!1}a.parentNode&&a.parentNode.removeChild(a)}("/".concat(o)),n(r),t.preventDefault()}return r.a.createElement("ul",{className:"list-group"},e.items.map(function(e,n){return r.a.createElement("li",{className:"list-group-item d-flex align-items-left",key:n},r.a.createElement("span",{className:"idx"},n+1,"."),r.a.createElement("span",{className:"token","data-idx":n,onClick:a},"/",e.token),t===n?r.a.createElement("span",{className:"copiedText"},"Copied!"):null,r.a.createElement("span",{className:"count"},k(e.count)))}))}(e,o,c):function(e){return r.a.createElement("div",{className:"emptyList"},e.emptyMessage||r.a.createElement("span",null,r.a.createElement("strong",null,e.label),": No memes found, try choosing from another list!"))}(e))}n(19);n(20);var j=function(e){return r.a.createElement("div",{className:"Login"},r.a.createElement("button",{onClick:function(){console.log("Logging in");try{if(!chrome||!chrome.identity)return void console.log("Not in an extension");!function(e,t){console.log("getToken");var n=chrome.identity.getRedirectURL("provider_cb"),a=new RegExp(n+"[#?](.*)"),r={interactive:e,url:"https://github.com/login/oauth/authorize?client_id="+v+"&redirect_uri="+encodeURIComponent("https://us-central1-git-meme-prod.cloudfunctions.net/oauth")};function o(e){var t=e.split(/&/),n={};return t.forEach(function(e){var t=e.split(/=/);n[t[0]]=t[1]}),console.log("parseRedirectFragment got values",n),n}function c(e){return i.apply(this,arguments)}function i(){return(i=Object(l.a)(s.a.mark(function e(n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.hasOwnProperty("access_token")){e.next=5;break}return e.next=3,u(n.access_token,n.user_id,n.avatar);case 3:e.next=6;break;case 5:t(new Error("Neither access_token nor code avialable."));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function u(e,t,n){return m.apply(this,arguments)}function m(){return(m=Object(l.a)(s.a.mark(function e(n,a,r){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(n);case 2:return e.next=4,g(a,r);case 4:t(null,{token:n,id:a,avatar:r});case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}f().then(function(){var e=Object(l.a)(s.a.mark(function e(n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("got github info ",n),n.token&&n.id&&n.avatar||(console.log("calling launchWebAuthFlow with options",r),chrome.identity.launchWebAuthFlow(r,function(e){if(console.log("launchWebAuthFlow callback with redirect ",e),chrome.runtime.lastError)return console.error("launchWebAuthFlow error",chrome.runtime.lastError),void t(new Error(chrome.runtime.lastError));var n=e.match(a);console.log("matches = ",n),n&&n.length>1?(console.log("calling handleProviderResponse"),c(o(n[1]))):t("Invalid redirect URI")}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}(!0,function(){var t=Object(l.a)(s.a.mark(function t(n,a){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("getToken complete","Error is ",n,"info is ",a),n?console.error(n):(console.log("got token info ",a),e.onAuth(a));case 2:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}())}catch(t){console.error(t)}}},"Log in with Github"))};function O(e){var t=Object(a.useState)({user:[],global:[]}),n=Object(i.a)(t,2),o=n[0],c=n[1],u=Object(a.useState)(""),s=Object(i.a)(u,2),l=s[0],m=s[1],f=Object(a.useState)(!0),p=Object(i.a)(f,2),h=p[0],d=p[1];return Object(a.useEffect)(function(){var t,n,a=e.userInfo.token&&null!==e.userInfo.id?(t=e.userInfo.id,n=e.userInfo.token,{Authorization:"Bearer ".concat(t,"___").concat(n),"Content-Type":"application/json"}):{};fetch(y+"/top_tokens",{headers:a}).then(function(e){if(e.ok)return e.json();throw new Error("Failed to fetch top tokens")}).then(function(e){c(e),d(!1)}).catch(function(e){m(e.message),d(!1)})},[]),h?null:r.a.createElement("div",{className:"TopTokensList"},l?r.a.createElement("div",null,"Error"):r.a.createElement(r.a.Fragment,null,r.a.createElement(x,{label:"Trending",items:o.global}),r.a.createElement(x,{label:"Your Memes",items:e.userInfo.token?o.user:[],emptyMessage:r.a.createElement("div",{className:"emptyMsg"},r.a.createElement("div",null,"Log in with your Github account to see the most popular memes used by you and your team"),r.a.createElement("div",null,r.a.createElement(j,{onAuth:e.onAuth})))})))}n(21);function N(){return a.createElement("div",{className:"Help"},a.createElement("strong",null,a.createElement("a",{href:"https://gitme.me",target:"_blank"},"GitMeme"))," ","brings lots of fun to Github by making it easy to include Gifs in your comments. In any text box, just type a forward slash and some text to search for an image, e.g ",a.createElement("span",{className:"token"},"/shipit"))}var _=function(){var e=Object(a.useState)({token:"",id:"",avatar:""}),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),u=Object(i.a)(c,2),s=u[0],l=u[1];return Object(a.useEffect)(function(){f().then(function(e){o(e),l(!0)})},[]),r.a.createElement("div",{className:"App"},r.a.createElement(N,null),s?r.a.createElement(O,{userInfo:n,onAuth:function(e){return o(e)}}):null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[9,1,2]]]);
//# sourceMappingURL=main.e63980b5.chunk.js.map