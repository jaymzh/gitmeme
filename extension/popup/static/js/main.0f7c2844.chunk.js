(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),a=n(5),c=n.n(a),i=(n(13),n(6)),u=(n(4),n(0)),s=n.n(u),l=n(2);function p(){return h.apply(this,arguments)}function h(){return(h=Object(l.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){chrome.storage.sync.get(["github_token","github_id","github_avatar"],function(t){e({token:t.github_token||null,id:t.github_id||null,avatar:t.github_avatar||null})})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f(e){return d.apply(this,arguments)}function d(){return(d=Object(l.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){chrome.storage.sync.set({github_token:t},function(){e()})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m(e,t){return g.apply(this,arguments)}function g(){return(g=Object(l.a)(s.a.mark(function e(t,n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){console.log("setGithubUserId ",t,n),chrome.storage.sync.set({github_id:t,github_avatar:n},function(){e()})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var w="9b9e17e168e82438cfb6";var b=function(e){return o.a.createElement("div",{className:"Login"},o.a.createElement("header",{className:"App-header"},o.a.createElement("button",{onClick:function(){chrome&&chrome.identity?function(e,t){console.log("getToken called"),p().then(function(){var e=Object(l.a)(s.a.mark(function e(n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:chrome.identity.launchWebAuthFlow(o,function(e){if(chrome.runtime.lastError)t(new Error(chrome.runtime.lastError));else{var n=e.match(r);n&&n.length>1?c(a(n[1])):t(new Error("Invalid redirect URI"))}});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var n=chrome.identity.getRedirectURL("provider_cb"),r=new RegExp(n+"[#?](.*)"),o={interactive:e,url:"https://github.com/login/oauth/authorize?client_id="+w+"&redirect_uri="+encodeURIComponent("https://us-central1-git-meme-prod.cloudfunctions.net/oauth")};function a(e){console.log("parseRedirectFragment called with",e);var t=e.split(/&/),n={};return t.forEach(function(e){var t=e.split(/=/);n[t[0]]=t[1]}),n}function c(e){return i.apply(this,arguments)}function i(){return(i=Object(l.a)(s.a.mark(function e(n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handleProviderResponse",n),!n.hasOwnProperty("access_token")){e.next=6;break}return e.next=4,u(n.access_token,n.user_id,n.avatar);case 4:e.next=7;break;case 6:t(new Error("Neither access_token nor code avialable."));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function u(e,t,n){return h.apply(this,arguments)}function h(){return(h=Object(l.a)(s.a.mark(function e(n,r,o){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Setting access_token: ",n,"user id",r,"avatar",o),e.next=3,f(n);case 3:return e.next=5,m(r,o);case 5:t(null,{token:n,id:r,avatar:o});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}}(!0,function(){var t=Object(l.a)(s.a.mark(function t(n,r){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n?console.error(n):(console.log("got token info ",r),e.onAuth(r));case 1:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()):console.log("Not in an extension")}},"Log in with Github")))},v=function(){var e=Object(r.useState)({token:"",id:"",avatar:""}),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)(function(){p().then(function(e){console.log("Popup got Github Info",e),a(e)})},[]),n.token?o.a.createElement("span",null,"Hello "+n.id):o.a.createElement(b,{onAuth:function(e){return a(e)}})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(v,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},4:function(e,t,n){},7:function(e,t,n){e.exports=n(15)}},[[7,1,2]]]);
//# sourceMappingURL=main.0f7c2844.chunk.js.map